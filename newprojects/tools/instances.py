import json
import csv
csv_file = "/Users/withheart/Desktop/ip.csv"
strs = [{"cpu_usage":0.0,"deployment_name":"dp-e5767cf406","cpu_usage_pct":0.0,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-detail?var-servicename=dp-e5767cf406-5697b5bc68&from=now-2h&to=now","stageDisplay":"小流量","gpu_request":0.0,"mem_usage_pct":0.0,"cpu_request":1.0,"mem_usage":0.0,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"canary","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.0,"uid":"fb0ff2c1-0daf-11e9-ae46-0cc47a920788","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-5697b5bc68-gxvhm&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_RZ&provider_type=K8S","creattime":"2019-01-01 18:28:29","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"1253616724","paas_cluster":"default","name":"dp-e5767cf406","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-5697b5bc68-gxvhm&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_RZ&provider_type=K8S","cpu_usage_pct":0.0,"graphics_usage":0.0,"mem_usage_pct":0.0,"mem_usage":0.0,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"canary","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"canary","PORT":"9237","PORT0":"9237","TCE_PRIMARY_PORT":"65321"},"node":"10.18.70.51","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-15T10:53:09Z\"}","LogicalCluster":"default","podip":"172.17.0.4","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9237,"port":65321}],"podName":"dp-e5767cf406-5697b5bc68-gxvhm","containerID":"f580d1bb619f873086980d8f45e5aa575b0969133f223b447f7950b56b4efb1b","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.705,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-pods?var-podname=dp-e5767cf406-5697b5bc68-gxvhm&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n18-070-051&var-datasource=bytetsd","idc":"LF_RZ"}],"desc":"WebNormal-default-小流量(LF_RZ)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-services?var-servicename=dp-e5767cf406&from=now-2h&to=now","idc":"LF_RZ"},{"cpu_usage":0.006,"deployment_name":"dp-e5767cf406","cpu_usage_pct":0.6,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-hl-service-detail?var-servicename=dp-e5767cf406-5474df46d9&from=now-2h&to=now","stageDisplay":"小流量","gpu_request":0.0,"mem_usage_pct":1.5,"cpu_request":1.0,"mem_usage":0.015,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"canary","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.006,"uid":"7dadd718-0fd8-11e9-9147-ac1f6b0b54bc","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-5474df46d9-86bxk&zone=China-North-LF&physical_cluster=WebNormal&idc=HL&provider_type=K8S","creattime":"2019-01-04 12:23:30","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"1030890285","paas_cluster":"default","name":"dp-e5767cf406","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-5474df46d9-86bxk&zone=China-North-LF&physical_cluster=WebNormal&idc=HL&provider_type=K8S","cpu_usage_pct":0.6,"graphics_usage":0.0,"mem_usage_pct":1.5,"mem_usage":0.015,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"canary","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"canary","PORT":"9233","PORT0":"9233","TCE_PRIMARY_PORT":"65321"},"usage":{"cpu":60,"memory":153},"node":"10.27.36.29","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-15T12:42:07Z\"}","LogicalCluster":"default","podip":"172.17.0.11","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9233,"port":65321}],"podName":"dp-e5767cf406-5474df46d9-86bxk","containerID":"f0bd0920f618431b42834b8f7c2a122d56a33b617f0a352e4cc1687e1d0ae062","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.703,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-pods?var-podname=dp-e5767cf406-5474df46d9-86bxk&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n27-036-029&var-datasource=bytetsd","idc":"HL"}],"desc":"WebNormal-default-小流量(HL)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-services?var-servicename=dp-e5767cf406&from=now-2h&to=now","idc":"HL"},{"cpu_usage":0.008,"deployment_name":"dp-e5767cf406","cpu_usage_pct":0.8,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-detail?var-servicename=dp-e5767cf406-67f88f4f4b&from=now-2h&to=now","stageDisplay":"小流量","gpu_request":0.0,"mem_usage_pct":1.5,"cpu_request":1.0,"mem_usage":0.015,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"canary","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.008,"uid":"fafc08e3-0daf-11e9-a7a6-7cd30adc4092","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-67f88f4f4b-kdt8c&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_YJD&provider_type=K8S","creattime":"2019-01-01 18:28:29","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"2394490906","paas_cluster":"default","name":"dp-e5767cf406","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-e5767cf406-67f88f4f4b-kdt8c&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_YJD&provider_type=K8S","cpu_usage_pct":0.8,"graphics_usage":0.0,"mem_usage_pct":1.5,"mem_usage":0.015,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"canary","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"canary","PORT":"9248","PORT0":"9248","TCE_PRIMARY_PORT":"65321"},"usage":{"cpu":80,"memory":154},"node":"10.3.49.55","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-15T22:13:42Z\"}","LogicalCluster":"default","podip":"172.26.47.134","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9248,"port":65321}],"podName":"dp-e5767cf406-67f88f4f4b-kdt8c","containerID":"44ad093890a6764980604ee045ce0e4e2a54a0e39448ca051f85fd27e0a8ef1d","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.705,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-pods?var-podname=dp-e5767cf406-67f88f4f4b-kdt8c&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n3-049-055&var-datasource=bytetsd","idc":"LF_YJD"}],"desc":"WebNormal-default-小流量(LF_YJD)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-services?var-servicename=dp-e5767cf406&from=now-2h&to=now","idc":"LF_YJD"},{"cpu_usage":0.006,"deployment_name":"dp-4b6281280a","cpu_usage_pct":0.6,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-detail?var-servicename=dp-4b6281280a-54df49494c&from=now-2h&to=now","stageDisplay":"单机房","gpu_request":0.0,"mem_usage_pct":1.5,"cpu_request":1.0,"mem_usage":0.015,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"single_dc","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.006,"uid":"672ad344-0db4-11e9-a7a6-7cd30adc4092","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-4b6281280a-54df49494c-s2nst&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_YJD&provider_type=K8S","creattime":"2019-01-01 19:00:08","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"1089050507","paas_cluster":"default","name":"dp-4b6281280a","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-4b6281280a-54df49494c-s2nst&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_YJD&provider_type=K8S","cpu_usage_pct":0.6,"graphics_usage":0.0,"mem_usage_pct":1.5,"mem_usage":0.015,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"single_dc","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"prod","PORT":"9244","PORT0":"9244","TCE_PRIMARY_PORT":"65321"},"usage":{"cpu":60,"memory":154},"node":"10.19.60.36","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-15T20:47:18Z\"}","LogicalCluster":"default","podip":"172.17.0.5","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9244,"port":65321}],"podName":"dp-4b6281280a-54df49494c-s2nst","containerID":"270a8dc6492aab3e47e2ce2570f3dd458adfe8caa08ff473db6f2b58d754b915","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.705,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-pods?var-podname=dp-4b6281280a-54df49494c-s2nst&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n19-060-036&var-datasource=bytetsd","idc":"LF_YJD"}],"desc":"WebNormal-default-单机房(LF_YJD)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-services?var-servicename=dp-4b6281280a&from=now-2h&to=now","idc":"LF_YJD"},{"cpu_usage":0.012,"deployment_name":"dp-bb4ea3754d","cpu_usage_pct":1.2,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-detail?var-servicename=dp-bb4ea3754d-6cbc5f46dd&from=now-2h&to=now","stageDisplay":"全流量","gpu_request":0.0,"mem_usage_pct":1.6,"cpu_request":1.0,"mem_usage":0.015,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"all_dc","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.012,"uid":"844df7cf-0db4-11e9-ae46-0cc47a920788","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-bb4ea3754d-6cbc5f46dd-2mmph&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_RZ&provider_type=K8S","creattime":"2019-01-01 19:00:58","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"2767190288","paas_cluster":"default","name":"dp-bb4ea3754d","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-bb4ea3754d-6cbc5f46dd-2mmph&zone=China-North-LF&physical_cluster=WebNormal&idc=LF_RZ&provider_type=K8S","cpu_usage_pct":1.2,"graphics_usage":0.0,"mem_usage_pct":1.6,"mem_usage":0.015,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"all_dc","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"prod","PORT":"9238","PORT0":"9238","TCE_PRIMARY_PORT":"65321"},"usage":{"cpu":120,"memory":155},"node":"10.18.70.51","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-15T10:53:09Z\"}","LogicalCluster":"default","podip":"172.17.0.5","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9238,"port":65321}],"podName":"dp-bb4ea3754d-6cbc5f46dd-2mmph","containerID":"ac55ac8b135faa53ba806b12761e530e1d72489606262a6b914e8861bb6c6f56","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.705,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-pods?var-podname=dp-bb4ea3754d-6cbc5f46dd-2mmph&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n18-070-051&var-datasource=bytetsd","idc":"LF_RZ"}],"desc":"WebNormal-default-全流量(LF_RZ)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-lf-services?var-servicename=dp-bb4ea3754d&from=now-2h&to=now","idc":"LF_RZ"},{"cpu_usage":0.007,"deployment_name":"dp-bb4ea3754d","cpu_usage_pct":0.7,"cluster":"default","cluster_id":34832,"grafana_resource":"https://grafana.byted.org/dashboard/db/tce-prod-hl-service-detail?var-servicename=dp-bb4ea3754d-5c997d99c&from=now-2h&to=now","stageDisplay":"全流量","gpu_request":0.0,"mem_usage_pct":1.5,"cpu_request":1.0,"mem_usage":0.015,"physicalCluster":"WebNormal","mem_request":1.0,"stage":"all_dc","logicluster":"default","graphics_usage":0.0,"grafana_history_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-service-history?var-psmname=jiang.test.demo2&var-paasclustername=default&var-cluster_name=WebNormal&var-downsample_in_sec=300&from=now-12h&to=now","graphics_request":0.0,"data":[{"cpu_usage":0.007,"uid":"e273ef5a-0fd8-11e9-9147-ac1f6b0b54bc","shellLink":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-bb4ea3754d-5c997d99c-lnc6w&zone=China-North-LF&physical_cluster=WebNormal&idc=HL&provider_type=K8S","creattime":"2019-01-04 12:26:20","image":"hub.byted.org/jiang.test.demo2:303a10a92a9b4852a570c758ad4741c3","labels":{"pod-template-hash":"175538557","paas_cluster":"default","name":"dp-bb4ea3754d","psm":"jiang.test.demo2"},"shell_link":"http://tce.byted.org/web_shell/?_sdk_disable=1&pod_name=dp-bb4ea3754d-5c997d99c-lnc6w&zone=China-North-LF&physical_cluster=WebNormal&idc=HL&provider_type=K8S","cpu_usage_pct":0.7,"graphics_usage":0.0,"mem_usage_pct":1.5,"mem_usage":0.015,"env":{"TCE_INSTANCE_WEIGHT":"10","TCE_ZONE":"China-North-LF","TCE_STAGE":"all_dc","TCE_CLUSTER_ID":"34832","TCE_TERMINATION_SECOND":"30","TCE_PORTS":"65321","TCE_ADDR":"http://tce.byted.org/","TCE_CLUSTER":"default","TCE_PSM":"jiang.test.demo2","TCE_PSM_GROUP":"default","TCE_PSM_OWNER":"jiangjingzhi","TCE_ENV":"prod","PORT":"9220","PORT0":"9220","TCE_PRIMARY_PORT":"65321"},"usage":{"cpu":70,"memory":154},"node":"10.26.17.156","statusDisplay":"运行中","clusterName":"WebNormal","statusDetail":"{\"startedAt\":\"2019-01-17T17:13:49Z\"}","LogicalCluster":"default","podip":"172.17.0.9","Limit":{"cpu":1,"memory":1073741824},"nodeport":[{"intent":"primary","protocol":"TCP","nodePort":9220,"port":65321}],"podName":"dp-bb4ea3754d-5c997d99c-lnc6w","containerID":"9458454afec37e2aed359a902d4c740db07bee940a289d7f74350b9ec61cb97c","podstatus":"Running","PSM":"jiang.test.demo2","podPhase":"Running","request":{"cpu":0.703,"memory":1073741824},"gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-pods?var-podname=dp-bb4ea3754d-5c997d99c-lnc6w&from=now-2h&to=now","sys_probe_url":"https://grafana.byted.org/dashboard/db/sysprobe-dashborad?refresh=10s&orgId=1&var-host=n26-017-156&var-datasource=bytetsd","idc":"HL"}],"desc":"WebNormal-default-全流量(HL)","gpu_usage":0.0,"grafana_url":"https://grafana.byted.org/dashboard/db/tce-prod-hl-services?var-servicename=dp-bb4ea3754d&from=now-2h&to=now","idc":"HL"}]
# dicts = json.loads(str)
# with open(csv_file, 'w') as csvfile:
#     spam_writer = csv.writer(csvfile, dialect='excel')
#     spam_writer.writerow(["ip"])
#     for item in strs:
#         for data in item['data']:
#             line = []
#             data = data['node'] + ":" + str(data['nodeport'][0]['nodePort'])
#             line.append(data)
#             spam_writer.writerow(line)

for item in strs:
    strs = ""
    for data in item['data']:
        data = '"http://' + data['node'] + ":" + str(data['nodeport'][0]['nodePort']) + '",'
        # data += "\n"
        strs += data
    print(strs)


# count
# with open("/Users/withheart/Desktop/ips") as f:
#     ips = {}
#     for line in f.readlines():
#         ip = line.strip("\n")
#         if ip not in ips.keys():
#             ips[ip] = 1
#         else:
#             ips[ip] += 1
#     print(ips)